@model LaborVolumeCalculator.Pages.Nirs.EditLaborVolumesModel;
@using LaborVolumeCalculator.Models.Dictionary

<div class="modal fade" id="softwareDevLaborGroupSelectionForm" tabindex="-1" aria-labelledby="softwareDevLaborGroupSelectionFormLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="softwareDevLaborGroupSelectionFormLabel">Комплексные работы по разработке СПО</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="addSoftwareLaborGroupSelectionBody">
            <form>
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                
                <label asp-for="SoftwareDevLaborGroupReg.SoftwareDevLaborGroup" class="control-label"></label>
                <div class="form-group">
                    @foreach (var item in (IEnumerable<SoftwareDevLaborGroup>)Model.ViewData["SoftwareDevLaborGroups"])
                    {
                        <div class="custom-control custom-radio">
                            <input type="radio" id="softDevLaborGroup-@item.ID" name="softDevLaborGroup" class="custom-control-input">
                            <label class="custom-control-label" for="softDevLaborGroup-@item.ID">@item.Name</label>
                        </div>
                    }
                </div>
                
                <div class="form-group">
                    <label asp-for="SoftwareDevLaborGroupReg.SolutionInnovationRate" class="control-label"></label>
                    @foreach (var item in (IEnumerable<SolutionInnovationRate>)Model.ViewData["SolutionInnovationRates"])
                    {
                        <div class="row justify-content-start">
                            <div class="col-1 pr-0">
                                <div class="custom-control custom-radio">
                                    <input type="radio" id="solutionInnovationRate-@item.ID" name="solutionInnovationRate" class="custom-control-input">
                                    <label class="custom-control-label" for="solutionInnovationRate-@item.ID">@item.Value</label>
                                </div>
                            </div>
                            <label class="col"for="solutionInnovationRate-@item.ID">@item.Name</label>
                        </div>
                    }
                </div>

                <div class="form-group row d-flex align-items-center">
                    <label asp-for="SoftwareDevLaborGroupReg.StandardModulesUsingRate" class="control-label col-auto" ></label>
                    <div class="col-sm-3">
                        <select name="StandardModulesUsingRateID" class="form-control form-control-sm" asp-items='(IEnumerable<SelectListItem>)Model.ViewData["StandardModulesUsingRateID"]'></select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label asp-for="SoftwareDevLaborGroupReg.TestsDevelopmentRate" class="control-label"></label>
                    <div class="container-fluid">
                        <div class="row border bg-secondary-light">
                            <div class="col-sm-3 border-right">Микро архитектура модулей</div>
                            <div class="col">
                                <div class="row border-bottom">
                                    <div class="col text-center"> Уровень тестирования</div>
                                </div>
                                <div class="row">
                                    @foreach (var scale in (IEnumerable<TestsScale>)Model.ViewData["TestsScales"])
                                        {
                                            <div class="col border-right text-center">@scale.Name</div>
                                        }
                                </div>
                            </div>
                        </div>
                        <div class="row border-left border-bottom bg-secondary-light">
                            <div class="col-sm-3 border-right">Уровень покрытия кода тестами</div>
                            @{ var testsScalesCount = ((IEnumerable<TestsScale>)Model.ViewData["TestsScales"]).Count(); }
                            @for (int i = 0; i < testsScalesCount; i++)
                            {
                                @foreach (var item in (IEnumerable<TestsCoverageLevel>)Model.ViewData["TestsCoverageLevels"])
                                {
                                    <div class="col border-right px-0 d-flex align-items-center justify-content-center"> @item.Name </div>
                                }
                            }
                        </div>

                        <div class="body" data-toggle="buttons">
                            @foreach (var microArch in (IEnumerable<ComponentsMicroArchitecture>)Model.ViewData["ComponentsMicroArchitectures"])
                            {
                                <div class="row border-left border-right border-bottom btn-group-toggle">
                                    <div class="col-sm-3 border-right">@microArch.Name</div>
                                    @foreach (var scale in (IEnumerable<TestsScale>)Model.ViewData["TestsScales"])
                                    {
                                        @foreach (var coverLevel in (IEnumerable<TestsCoverageLevel>)Model.ViewData["TestsCoverageLevels"])
                                        {
                                            var rate = ((TestsDevelopmentRate[])Model.ViewData["TestsDevelopmentRates"])
                                                .Where(m => m.ComponentsMicroArchitectureID == microArch.ID && m.TestsCoverageLevelID == coverLevel.ID && m.TestsScaleID == scale.ID)
                                                .FirstOrDefault();
                                            
                                            <div class="col-sm-1 btn btn-outline-secondary border-0 p-0 d-flex align-items-center justify-content-center">
                                                <input type="radio" name="options" id="option-@rate.ID"> @rate.Value </div>
                                        }
                                    }
                                </div>
                            }
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label asp-for="SoftwareDevLaborGroupReg.InfrastructureComplexityRate" class="control-label"></label>
                    @foreach (var item in (IEnumerable<InfrastructureComplexityRate>)Model.ViewData["InfrastructureComplexityRates"])
                    {
                        <div class="row justify-content-start">
                            <div class="col-1 mr-2">
                                <div class="custom-control custom-radio">
                                    <input type="radio" id="infrastructureComplexityRate-@item.ID" name="infrastructureComplexityRate" class="custom-control-input">
                                    <label class="custom-control-label" for="infrastructureComplexityRate-@item.ID">@item.Value</label>
                                </div>
                            </div>
                            <label class="col"for="infrastructureComplexityRate-@item.ID">@item.Name</label>
                        </div>
                    }
                </div>
                
                <div class="form-group">
                    <label asp-for="SoftwareDevLaborGroupReg.ArchitectureComplexityRate" class="control-label"></label>
                    <div class="container-fluid">
                        <div class="row border bg-secondary-light">
                            <div class="col-sm-3 border-right">Макроархитектура компонент </div>
                            <div class="col">
                                <div class="row border-bottom">
                                    <div class="col text-center"> Архитектура взаимодействия компонент </div>
                                </div>
                                <div class="row">
                                    @foreach (var item in (IEnumerable<ComponentsInteractionArchitecture>)Model.ViewData["ComponentsInteractionArchitectures"])
                                    {
                                        <div class="col border-right text-center">@item.Name</div>
                                    }
                                </div>
                            </div>
                        </div>
                        <div class="body" data-toggle="buttons">
                            @foreach (var macroArchitecture in (IEnumerable<ComponentsMakroArchitecture>)Model.ViewData["ComponentsMakroArchitectures"])
                            {
                                <div class="row border-left border-right border-bottom btn-group-toggle">
                                    <div class="col-sm-3 border-right">@macroArchitecture.Name</div>
                                    @foreach (var interactionArchitecture in (IEnumerable<ComponentsInteractionArchitecture>)Model.ViewData["ComponentsInteractionArchitectures"])
                                    {
                                        var rate = ((ArchitectureComplexityRate[])Model.ViewData["ArchitectureComplexityRates"])
                                            .Where(m => m.ComponentsInteractionArchitectureID == interactionArchitecture.ID && m.ComponentsMakroArchitectureID == macroArchitecture.ID)
                                            .FirstOrDefault();
                                        
                                        <div class="col-sm btn btn-outline-secondary border-0 p-0 d-flex align-items-center justify-content-center">
                                            <input type="radio" name="acr" id="acr-@rate.ID"> @rate.Value </div>
                                    }
                                </div>
                            }
                        </div>
                    </div>
                </div>


            </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
        <button type="button" class="btn btn-primary btnOK" data-nirStageID="0">ОК</button>
      </div>
    </div>
  </div>
</div>

